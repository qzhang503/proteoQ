devtools::document(pkg  = "C:\\Results\\R\\proteoq")
dat_dir <- "C:\\The\\SM\\Example"
# dat_dir <- "C:\\Results\\Mertins_Nat_Protoc_2018_SM"
load_expts()
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
dat_dir <- "C:\\Results\\Mertins_Nat_Protoc_2018_SM"
load_expts()
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
temp = df %>%
filters_in_call(!!!lang_dots) %>%
dplyr::rename(prot_acc = accession_number)
View(temp)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
View(df)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
View(df)
df_sub <- df %>% dplyr::filter(!is.na(variableSites))
df_sub <- df %>% dplyr::filter(!is.na(variableSites))
View(df_sub)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
pos_matrix <- df_sub %>%
dplyr::select(variableSites) %>%
dplyr::mutate(variableSites = as.character(variableSites)) %$%
stringr::str_split(.$variableSites, " ") %>%
plyr::ldply(., rbind) %>%
`names<-`(paste0("mod_", names(.)))
View(pos_matrix)
pos_matrix <- df_sub %>%
dplyr::select(variableSites) %>%
dplyr::mutate(variableSites = as.character(variableSites)) %$%
stringr::str_split(.$variableSites, " ") %>%
plyr::ldply(., rbind) %>%
`names<-`(paste0("mod_", names(.))) %>%
purrr::map(~ gsub("[A-z]", "", .)) %>%
dplyr::bind_cols() %>%
dplyr::mutate_at(.vars = grep("^mod_", names(.)), as.numeric) %>%
dplyr::bind_cols(df_sub %>% dplyr::select(pep_seq, pep_start))
View(pos_matrix)
pos_matrix <- df_sub %>%
dplyr::select(variableSites) %>%
dplyr::mutate(variableSites = as.character(variableSites)) %$%
stringr::str_split(.$variableSites, " ") %>%
plyr::ldply(., rbind) %>%
`names<-`(paste0("mod_", names(.))) %>%
purrr::map(~ gsub("[A-z]", "", .)) %>%
dplyr::bind_cols() %>%
dplyr::mutate_at(.vars = grep("^mod_", names(.)), as.numeric) %>%
dplyr::bind_cols(df_sub %>% dplyr::select(pep_seq, pep_start)) %>%
dplyr::mutate_at(.vars = grep("^mod_", names(.)), ~ {.x + 1 - pep_start})
View(pos_matrix)
View(pos_matrix)
df_sub <- local({
for (k in 1:ncol(pos_matrix)) {
rows <- !is.na(pos_matrix[, k])
locales <- pos_matrix[rows, k]
lowers <- substr(df_sub$pep_seq_mod[rows], locales, locales) %>% tolower()
substr(df_sub$pep_seq_mod[rows], locales, locales) <- lowers
}
return(df_sub)
})
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
View(df_sub)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
load_expts()
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
load_expts()
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
View(df_sub)
df_sub <- df %>% dplyr::filter(!grepl("^TMT", nterm))
df_sub <- df %>%
dplyr::filter(nterm == "Acetyl")
df_sub <- df %>% dplyr::filter(!grepl("^TMT", .$nterm))
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
?normPSM
df_sub <- df %>% dplyr::filter(cterm == "Acetyl")
idx = names(df) == "cterm"
idx
idx <- which(names(df) == "cterm")
idx
is_empty(idx)
df$cterm = df$nterm
!is_empty(which(names(df) == "nterm"))
if (!is_empty(which(names(df) == "nterm"))) {
df_sub <- df %>% dplyr::filter(nterm == "Acetyl")
if (nrow(df_sub) > 0) {
df_sub$pep_seq_mod <- paste0("_", df_sub$pep_seq_mod)
df <- dplyr::bind_rows(
df %>% dplyr::filter(nterm != "Acetyl"),
df_sub
)
}
}
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
df$cterm = df$nterm
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
seq_along(pos_matrix)
for (k in seq_along(pos_matrix)) {
rows <- !is.na(pos_matrix[, k])
locales <- pos_matrix[rows, k]
lowers <- substr(df_sub$pep_seq_mod[rows], locales, locales) %>% tolower()
substr(df_sub$pep_seq_mod[rows], locales, locales) <- lowers
}
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPSM(
group_psm_by = pep_seq_mod,
group_pep_by = gene,
fasta = c("~\\proteoQ\\dbs\\fasta\\refseq\\refseq_hs_2013_07.fasta",
"~\\proteoQ\\dbs\\fasta\\refseq\\refseq_mm_2013_07.fasta"),
rptr_intco = 3000,
rm_craps = TRUE,
rm_krts = FALSE,
rm_outliers = FALSE,
annot_kinases = TRUE,
plot_rptr_int = TRUE,
plot_log2FC_cv = TRUE,
filter_peps = exprs(score >= 10),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
normPep(
method_psm_pep = median,
method_align = MGKernel,
range_log2r = c(5, 95),
range_int = c(5, 95),
n_comp = 3,
seed = 749662,
maxit = 200,
epsilon = 1e-05,
)
pepHist(
scale_log2r = TRUE,
show_curves = TRUE,
show_vline = TRUE,
xmin = -1,
xmax = 1,
ncol = 10,
)
# peptide histograms with scaling and filtration
pepHist(
scale_log2r = TRUE,
show_curves = TRUE,
show_vline = TRUE,
xmin = -1,
xmax = 1,
ncol = 10,
filter_by = exprs(pep_n_psm >= 10),
filename = "pepHist_npsm10.png",
)
# protein tables
normPrn(
method_pep_prn = median,
method_align = MGKernel,
range_log2r = c(20, 95),
range_int = c(5, 95),
n_comp = 2,
seed = 749662,
maxit = 200,
epsilon = 1e-05,
)
?anal_prnNMF
?gspaMap
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
?prnGSVA
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
force(gset_nm)
force(logFC_cutoff)
force(pval_cutoff)
force(var_cutoff)
dat_dir
dat_dir <- "C:\\Results\\Mertins_Nat_Protoc_2018_four_sites"
load_expts()
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq_dev")
devtools::document(pkg  = "C:\\Results\\R\\proteoq_dev")
dat_dir <- "C:\\Results\\Mertins_Nat_Protoc_2018_four_sites"
load_expts()
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
devtools::document(pkg  = "C:\\Results\\R\\proteoq_dev")
setwd("c:\\results\\r\\proteoq")
library(GSVA)
install.packages("GSVA")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GSVA")
library(GSVA)
devtools::document(pkg  = "C:\\Results\\R\\proteoq_dev")
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
names(df)
devtools::document(pkg  = "C:\\Results\\R\\proteoq_dev")
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
id <- rlang::as_string(rlang::enexpr(id))
dots = rlang::enexprs(...)
fmls <- dots %>% .[grepl("^\\s*~", .)]
dots <- dots %>% .[! names(.) %in% names(fmls)]
filter_dots <- dots %>% .[purrr::map_lgl(., is.language)] %>% .[grepl("^filter_", names(.))]
arrange_dots <- dots %>% .[purrr::map_lgl(., is.language)] %>% .[grepl("^arrange_", names(.))]
select_dots <- dots %>% .[purrr::map_lgl(., is.language)] %>% .[grepl("^select_", names(.))]
dots <- dots %>% .[! . %in% c(filter_dots, arrange_dots, select_dots)]
if (purrr::is_empty(fmls)) stop("Formula(s) of contrasts not available.", call. = FALSE)
species <- df$species %>% unique() %>% as.character()
gsets <- load_dbs(gset_nms, species)
devtools::document(pkg  = "C:\\Results\\R\\proteoq_dev")
prnGSVA(
scale_log2r = TRUE,
impute_na = FALSE,
min.sz = 10,
verbose = FALSE,
parallel.sz = 0,
mx.diff = TRUE,
gset_nm = c("c2_msig"),
)
gset_nm
?prnGSPA
?prnGSPA
devtools::document(pkg  = "C:\\Results\\R\\proteoq")
prnGSPA(
pval_cutoff = 5E-2,
logFC_cutoff = log2(1.2),
gspval_cutoff = 5E-2,
gset_nms = c("go_sets", "kegg_sets"),
impute_na = FALSE,
)
