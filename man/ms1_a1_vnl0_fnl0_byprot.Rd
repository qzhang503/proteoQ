% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ms1_masses.R
\name{ms1_a1_vnl0_fnl0_byprot}
\alias{ms1_a1_vnl0_fnl0_byprot}
\title{Helper by individual proteins.}
\usage{
ms1_a1_vnl0_fnl0_byprot(
  prot_peps,
  amods,
  aa_masses,
  vmods_nl = NULL,
  fmods_nl = NULL,
  include_insource_nl = FALSE,
  maxn_vmods_per_pep = 5L,
  maxn_sites_per_vmod = 3L,
  digits = 4L
)
}
\arguments{
\item{prot_peps}{Lists of named peptide masses under a protein.}

\item{amods}{\code{Anywhere} variable modifications.}

\item{aa_masses}{A named list containing the (mono-isotopic) masses of amino
acid residues.}

\item{include_insource_nl}{Logical Logical; if TRUE, includes MS1 precursor
masses with the losses of neutral species prior to MS2 fragmentation. The
default is FALSE. The setting at TRUE remains experimenting by allowing
additional masses in the universe of MS1 precursors. The offsets in NLs (by
adding back precursor masses) have not yet taken into account in MS2 ion
searches. A more systemically approach such as \code{open} MS1 masses might
be developed in the future.}

\item{maxn_vmods_per_pep}{The maximum number of variable modifications per
peptide.}

\item{maxn_sites_per_vmod}{Integer; the maximum number of combinatorial
variable modifications per site in a per peptide sequence.}

\item{digits}{Integer; the number of decimal places to be used.}
}
\description{
(7) "amods+ tmod- vnl- fnl-"; (8) "amods+ tmod-+ vnl- fnl-".
}
\examples{
\donttest{
m0 <- calc_monopeptide("HQGVMCNVGMGQKMNSC", NULL, NULL)
stopifnot(unlist(m0$mass, use.names = FALSE) - 1822.7405 < 1e-4)

m1 <- calc_monopeptide("HQGVMCNVGMGQKMNSC", "TMT6plex (N-term)", NULL)
stopifnot(unlist(m1$mass, use.names = FALSE) - 2051.9035 < 1e-4)

# (7) "amods+ tmod- vnl- fnl-"
aa_masses_all <- calc_aamasses(fixedmods = c("TMT6plex (N-term)"), 
                               varmods = c("Deamidated (N)", 
                                           "Carbamidomethyl (C)"), 
                               add_varmasses = FALSE, 
                               add_nlmasses = FALSE)

pep <- c("HQGVMCNVGMGQKMNSC" = 2051.90346)
amods <- list(`Deamidated (N)` = c("Anywhere" = "N"), 
              `Carbamidomethyl (C)` = c("Anywhere" = "C"))

x <- ms1_a1_vnl0_fnl0_byprot(pep, amods, aa_masses_all[[4]])

stopifnot(x[[1]] - 2109.9089 < 1e-4, 
          x[[2]] - 2166.9304 < 1e-4, 
          x[[3]] - 2110.8930 < 1e-4, 
          x[[4]] - 2167.9144 < 1e-4)
          

# (8) "amods+ tmod+ vnl- fnl-"
aa_masses_all <- calc_aamasses(fixedmods = "TMT6plex (K)", 
                               varmods = c("Deamidated (N)", 
                                           "Carbamidomethyl (S)", 
                                           "Acetyl (Protein N-term)"), 
                               add_varmasses = FALSE, 
                               add_nlmasses = FALSE)

pep <- c("HQGVMNVGMGQKSMNS" = 1932.9171) # + TMT6plex (K)
amods <- list(`Deamidated (N)` = c("Anywhere" = "N"), 
              `Carbamidomethyl (S)` = c("Anywhere" = "S"))
              
x <- ms1_a1_vnl0_fnl0_byprot(pep, amods, aa_masses_all[[8]])

stopifnot(x[[1]] - 1990.9226 < 1e-4, 
          x[[2]] - 1991.9066 < 1e-4, 
          x[[3]] - 2047.9440 < 1e-4, 
          x[[4]] - 2048.9281 < 1e-4)

}
}
